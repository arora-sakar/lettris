document.addEventListener("DOMContentLoaded",(()=>{const e="#5cdb95",r="#41b3a3",t="#8ee4af",n=-1,l="inset",o="outset",s=new Array;let u=0,c=null,a=!1;const d=document.querySelector("#display"),y=document.querySelector("#start-button"),f=document.querySelector("#back-button");let T=null,b=new Array,x=null;const q="EEEEEEEEEEAAAAAAAARRRRRRRIIIIIIIOOOOOOOTTTTTTTNNNNNNNSSSSSSLLLLLCCCCCUUUUDDDPPPMMMHHHGGBBFFYYWKVXZJQ",g=document.querySelector(".grid-container");for(i=0;i<16;i++){const e=new Array;for(j=0;j<10;j++){let r=document.createElement("div");r.addEventListener("click",h),r.r=i,r.c=j,r.selected=n,r.letter="",e.push(r),g.appendChild(r)}b.push(e)}function h(i){(function(e){return!a&&e.selected==n&&""!==e.letter&&null!=T})(this)&&(this.style.border=l,this.style.backgroundColor=e,null==x&&(x=new Array,d.innerText=""),d.innerText=d.innerText+this.innerText,this.selected=x.push(this)-1,E(d.innerText)?(d.style.border=o,d.style.backgroundColor=r):(d.style.border=l,d.style.backgroundColor=t))}function k(){if(function(){if(null==c)return!0;for(i=0;i<10;i++)if(c[i].r<15&&(square=b[c[i].r+1][i],""===square.letter))return!1;return!0}())!function(){for(c=new Array,i=0;i<10;i++){if(square=b[0][i],""!==square.innerText){a=!0;break}idx=Math.floor(Math.random()*q.length),square.letter=q[idx],c.push(square)}a&&(clearInterval(T),c=null,alert("Game Over!!"),y.innerText="START")}();else for(function(){if(null!=c)for(i=0;i<10;i++)square=c[i],square.innerText="",square.style.border="",square.style.backgroundColor=e}(),i=0;i<10;i++)if(t=c[i].r,s=c[i].c,!(t>=15||""!==b[t+1][s].letter)){let e=c[i],r=b[c[i].r+1][c[i].c];r.letter=e.letter,e.letter="",e.selected!=n&&(r.selected=e.selected,e.selected=n,x[r.selected]=r),c[i]=r}var t,s;a||function(){if(null!=c)for(i=0;i<10;i++)square=c[i],""!==square.letter&&(square.innerText=square.letter,square.selected!=n?(square.style.border=l,square.style.backgroundColor=e):(square.style.border=o,square.style.backgroundColor=r))}()}function C(){k()}function E(e){return s.includes(e)}function A(r){if(r.selected==n)return;let t=r.r,l=r.c;for(;t>0&&""!=b[t-1][l].innerText;)b[t-1][l].selected!=n&&A(b[t-1][l]),b[t][l].letter=b[t-1][l].letter,b[t][l].innerText=b[t-1][l].innerText,b[t][l].style.border=b[t-1][l].style.border,b[t][l].style.backgroundColor=b[t-1][l].style.backgroundColor,t--;b[t][l].letter="",b[t][l].innerText="",b[t][l].style.border="",b[t][l].style.backgroundColor=e,r.selected=n}!async function(e){const r=await fetch(e);let t=(await r.text()).split("\n");for(i=0;i<t.length;i++)s.push(t[i].replace("\r",""))}("/words3.txt"),y.addEventListener("click",(()=>{a&&function(){for(i=0;i<b.length;i++)for(j=0;j<b[i].length;j++)b[i][j].selected=n,b[i][j].letter="",b[i][j].innerText="",b[i][j].style.border="",b[i][j].style.backgroundColor=e;x=null,clearInterval(T),T=null,a=!1,c=null,d.innerText="",u=0,d.innerText="Score: "+u,y.innerText="START"}(),T?(clearInterval(T),T=null,y.innerText="START"):(T=setInterval(C,1e3),y.innerText="PAUSE")})),d.addEventListener("click",(()=>{if(null!=x&&E(d.innerText)){for(i=0;i<x.length;i++)A(x[i]);var e;u+=(e=d.innerText.length)*(e-1)/2,x=null,d.innerText="",d.style.backgroundColor=t,d.style.border=l,d.innerText="Score: "+u}})),document.addEventListener("keyup",(function(e){null!=T&&40===e.keyCode&&k()})),f.addEventListener("click",(()=>{if(null!=x&&(square=x.pop(),square&&square.selected!=n)){square.style.border=o,square.style.backgroundColor=r,square.selected=n;let e=d.innerText,s="";for(i=0;i<e.length-1;i++)s+=e[i];d.innerText=s,E(d.innerText)?(d.style.border=o,d.style.backgroundColor=r):(d.style.border=l,d.style.backgroundColor=t)}}))}));